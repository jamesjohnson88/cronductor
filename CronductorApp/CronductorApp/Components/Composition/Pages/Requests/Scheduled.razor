@page "/requests/scheduled"
@page "/requests"
@rendermode InteractiveServer
@using CronductorApp.Services
@inject RequestService RequestService
@inject NavigationManager Navigation

<PageTitle>Scheduled Requests - Cronductor</PageTitle>

<div class="requests-page">
    <RequestsSubNav />
    <ScheduledRequestsSection ScheduledRequests="@RequestService.ScheduledRequests" OnAddRequest="@AddRequest"
        OnEditRequest="@EditRequest" OnDeleteRequest="@DeleteRequest" />
</div>

@code {
    protected override void OnInitialized()
    {
        if (!RequestService.ScheduledRequests.Any())
        {
            RequestService.InitializeSampleData();
        }
    }

    private async Task AddRequest()
    {
        Navigation.NavigateTo("/requests/scheduled/new");
        await Task.CompletedTask;
    }

    private async Task EditRequest(string requestId)
    {
        Navigation.NavigateTo($"/requests/scheduled/edit/{requestId}");
        await Task.CompletedTask;
    }

    private async Task DeleteRequest(string requestId)
    {
        await RequestService.DeleteRequest(requestId);
    }
}
